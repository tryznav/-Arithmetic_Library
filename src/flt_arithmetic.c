//flt_arithmetic.c

#include "flt_arithmetic.h"

#define POW2EXP  0.075977616f
#define T2      1.882352948
#define T1      2.823529482

my_float   flt_add(my_float a, my_float b){
    return a + b;
}

my_float   flt_sub(my_float a, my_float b){
        return a - b;
}

my_float   flt_mul(my_float a, my_float b){
    return a * b;
}

my_float   flt_mac(my_float a, my_float b, my_float c){
        return a + (b * c);
}

my_float   flt_msub(my_float a, my_float b, my_float c){
        return a - (b * c);
}

my_float   flt_abs(my_float a){
        return (a < 0) ? -a: a;
}

my_float   flt_neg(my_float a){
        return -a;
}

my_float   flt_div(my_float N, my_float  D){
    my_float  Dsh = D * POW2EXP; ///powf(2, M_E + 1);
    my_float  Nsh = N * POW2EXP; //powf(2, M_E + 1);

    my_float x = T1 - T2 * Dsh;
    
    for(int i = 0; i < 3; i++){
        x = x + x*(1.0f - Dsh * x);
    }
    return x * Nsh;
}

my_float   flt_pow2(my_float n){
        
        n = -n;
        return n;
        //
}

POW2_FLT[512] = {
1073741824, // -1.000000, 0.500000
1075196443, // -0.998047, 0.500677
1076653033, // -0.996094, 0.501356
1078111596, // -0.994141, 0.502035
1079572135, // -0.992188, 0.502715
1081034653, // -0.990234, 0.503396
1082499152, // -0.988281, 0.504078
1083965636, // -0.986328, 0.504761
1085434105, // -0.984375, 0.505445
1086904565, // -0.982422, 0.506129
1088377016, // -0.980469, 0.506815
1089851462, // -0.978516, 0.507502
1091327905, // -0.976563, 0.508189
1092806349, // -0.974609, 0.508878
1094286795, // -0.972656, 0.509567
1095769247, // -0.970703, 0.510257
1097253708, // -0.968750, 0.510949
1098740179, // -0.966797, 0.511641
1100228664, // -0.964844, 0.512334
1101719166, // -0.962891, 0.513028
1103211687, // -0.960938, 0.513723
1104706230, // -0.958984, 0.514419
1106202797, // -0.957031, 0.515116
1107701392, // -0.955078, 0.515814
1109202017, // -0.953125, 0.516512
1110704675, // -0.951172, 0.517212
1112209369, // -0.949219, 0.517913
1113716101, // -0.947266, 0.518614
1115224875, // -0.945313, 0.519317
1116735692, // -0.943359, 0.520021
1118248556, // -0.941406, 0.520725
1119763470, // -0.939453, 0.521430
1121280435, // -0.937500, 0.522137
1122799456, // -0.935547, 0.522844
1124320535, // -0.933594, 0.523553
1125843674, // -0.931641, 0.524262
1127368877, // -0.929688, 0.524972
1128896146, // -0.927734, 0.525683
1130425484, // -0.925781, 0.526395
1131956894, // -0.923828, 0.527109
1133490379, // -0.921875, 0.527823
1135025941, // -0.919922, 0.528538
1136563583, // -0.917969, 0.529254
1138103308, // -0.916016, 0.529971
1139645119, // -0.914063, 0.530689
1141189019, // -0.912109, 0.531408
1142735011, // -0.910156, 0.532127
1144283097, // -0.908203, 0.532848
1145833280, // -0.906250, 0.533570
1147385563, // -0.904297, 0.534293
1148939949, // -0.902344, 0.535017
1150496441, // -0.900391, 0.535742
1152055041, // -0.898438, 0.536467
1153615753, // -0.896484, 0.537194
1155178579, // -0.894531, 0.537922
1156743523, // -0.892578, 0.538651
1158310586, // -0.890625, 0.539380
1159879773, // -0.888672, 0.540111
1161451085, // -0.886719, 0.540843
1163024526, // -0.884766, 0.541575
1164600098, // -0.882813, 0.542309
1166177805, // -0.880859, 0.543044
1167757649, // -0.878906, 0.543780
1169339634, // -0.876953, 0.544516
1170923761, // -0.875000, 0.545254
1172510035, // -0.873047, 0.545993
1174098458, // -0.871094, 0.546732
1175689032, // -0.869141, 0.547473
1177281762, // -0.867188, 0.548215
1178876649, // -0.865234, 0.548957
1180473696, // -0.863281, 0.549701
1182072908, // -0.861328, 0.550446
1183674285, // -0.859375, 0.551191
1185277832, // -0.857422, 0.551938
1186883552, // -0.855469, 0.552686
1188491447, // -0.853516, 0.553434
1190101520, // -0.851563, 0.554184
1191713774, // -0.849609, 0.554935
1193328212, // -0.847656, 0.555687
1194944838, // -0.845703, 0.556440
1196563653, // -0.843750, 0.557193
1198184662, // -0.841797, 0.557948
1199807866, // -0.839844, 0.558704
1201433270, // -0.837891, 0.559461
1203060875, // -0.835938, 0.560219
1204690686, // -0.833984, 0.560978
1206322704, // -0.832031, 0.561738
1207956934, // -0.830078, 0.562499
1209593377, // -0.828125, 0.563261
1211232037, // -0.826172, 0.564024
1212872917, // -0.824219, 0.564788
1214516020, // -0.822266, 0.565553
1216161349, // -0.820313, 0.566319
1217808907, // -0.818359, 0.567086
1219458697, // -0.816406, 0.567855
1221110722, // -0.814453, 0.568624
1222764985, // -0.812500, 0.569394
1224421489, // -0.810547, 0.570166
1226080238, // -0.808594, 0.570938
1227741233, // -0.806641, 0.571712
1229404478, // -0.804688, 0.572486
1231069977, // -0.802734, 0.573262
1232737732, // -0.800781, 0.574038
1234407746, // -0.798828, 0.574816
1236080023, // -0.796875, 0.575595
1237754565, // -0.794922, 0.576374
1239431376, // -0.792969, 0.577155
1241110458, // -0.791016, 0.577937
1242791815, // -0.789063, 0.578720
1244475450, // -0.787109, 0.579504
1246161366, // -0.785156, 0.580289
1247849565, // -0.783203, 0.581075
1249540052, // -0.781250, 0.581862
1251232829, // -0.779297, 0.582651
1252927899, // -0.777344, 0.583440
1254625265, // -0.775391, 0.584230
1256324931, // -0.773438, 0.585022
1258026899, // -0.771484, 0.585814
1259731173, // -0.769531, 0.586608
1261437756, // -0.767578, 0.587403
1263146651, // -0.765625, 0.588198
1264857861, // -0.763672, 0.588995
1266571389, // -0.761719, 0.589793
1268287239, // -0.759766, 0.590592
1270005412, // -0.757813, 0.591392
1271725914, // -0.755859, 0.592194
1273448746, // -0.753906, 0.592996
1275173913, // -0.751953, 0.593799
1276901416, // -0.750000, 0.594604
1278631260, // -0.748047, 0.595409
1280363447, // -0.746094, 0.596216
1282097981, // -0.744141, 0.597023
1283834865, // -0.742188, 0.597832
1285574101, // -0.740234, 0.598642
1287315694, // -0.738281, 0.599453
1289059646, // -0.736328, 0.600265
1290805961, // -0.734375, 0.601078
1292554642, // -0.732422, 0.601893
1294305691, // -0.730469, 0.602708
1296059113, // -0.728516, 0.603525
1297814910, // -0.726563, 0.604342
1299573085, // -0.724609, 0.605161
1301333643, // -0.722656, 0.605981
1303096586, // -0.720703, 0.606802
1304861916, // -0.718750, 0.607624
1306629639, // -0.716797, 0.608447
1308399756, // -0.714844, 0.609271
1310172271, // -0.712891, 0.610097
1311947188, // -0.710938, 0.610923
1313724509, // -0.708984, 0.611751
1315504237, // -0.707031, 0.612579
1317286377, // -0.705078, 0.613409
1319070931, // -0.703125, 0.614240
1320857903, // -0.701172, 0.615072
1322647295, // -0.699219, 0.615906
1324439112, // -0.697266, 0.616740
1326233356, // -0.695313, 0.617576
1328030031, // -0.693359, 0.618412
1329829139, // -0.691406, 0.619250
1331630685, // -0.689453, 0.620089
1333434672, // -0.687500, 0.620929
1335241102, // -0.685547, 0.621770
1337049980, // -0.683594, 0.622612
1338861308, // -0.681641, 0.623456
1340675090, // -0.679688, 0.624300
1342491329, // -0.677734, 0.625146
1344310029, // -0.675781, 0.625993
1346131193, // -0.673828, 0.626841
1347954823, // -0.671875, 0.627690
1349780925, // -0.669922, 0.628541
1351609500, // -0.667969, 0.629392
1353440552, // -0.666016, 0.630245
1355274085, // -0.664063, 0.631099
1357110102, // -0.662109, 0.631954
1358948606, // -0.660156, 0.632810
1360789600, // -0.658203, 0.633667
1362633089, // -0.656250, 0.634525
1364479075, // -0.654297, 0.635385
1366327562, // -0.652344, 0.636246
1368178553, // -0.650391, 0.637108
1370032052, // -0.648438, 0.637971
1371888062, // -0.646484, 0.638835
1373746586, // -0.644531, 0.639701
1375607628, // -0.642578, 0.640567
1377471191, // -0.640625, 0.641435
1379337278, // -0.638672, 0.642304
1381205894, // -0.636719, 0.643174
1383077041, // -0.634766, 0.644045
1384950723, // -0.632813, 0.644918
1386826943, // -0.630859, 0.645792
1388705705, // -0.628906, 0.646666
1390587012, // -0.626953, 0.647543
1392470868, // -0.625000, 0.648420
1394357276, // -0.623047, 0.649298
1396246240, // -0.621094, 0.650178
1398137762, // -0.619141, 0.651059
1400031847, // -0.617188, 0.651941
1401928498, // -0.615234, 0.652824
1403827719, // -0.613281, 0.653708
1405729512, // -0.611328, 0.654594
1407633882, // -0.609375, 0.655481
1409540832, // -0.607422, 0.656369
1411450365, // -0.605469, 0.657258
1413362484, // -0.603516, 0.658148
1415277195, // -0.601563, 0.659040
1417194499, // -0.599609, 0.659933
1419114400, // -0.597656, 0.660827
1421036903, // -0.595703, 0.661722
1422962010, // -0.593750, 0.662618
1424889725, // -0.591797, 0.663516
1426820051, // -0.589844, 0.664415
1428752993, // -0.587891, 0.665315
1430688553, // -0.585938, 0.666216
1432626735, // -0.583984, 0.667119
1434567543, // -0.582031, 0.668023
1436510980, // -0.580078, 0.668928
1438457050, // -0.578125, 0.669834
1440405757, // -0.576172, 0.670741
1442357103, // -0.574219, 0.671650
1444311093, // -0.572266, 0.672560
1446267730, // -0.570313, 0.673471
1448227018, // -0.568359, 0.674383
1450188959, // -0.566406, 0.675297
1452153559, // -0.564453, 0.676212
1454120821, // -0.562500, 0.677128
1456090747, // -0.560547, 0.678045
1458063342, // -0.558594, 0.678964
1460038610, // -0.556641, 0.679883
1462016553, // -0.554688, 0.680805
1463997176, // -0.552734, 0.681727
1465980482, // -0.550781, 0.682650
1467966475, // -0.548828, 0.683575
1469955158, // -0.546875, 0.684501
1471946536, // -0.544922, 0.685429
1473940611, // -0.542969, 0.686357
1475937388, // -0.541016, 0.687287
1477936869, // -0.539063, 0.688218
1479939060, // -0.537109, 0.689150
1481943963, // -0.535156, 0.690084
1483951582, // -0.533203, 0.691019
1485961920, // -0.531250, 0.691955
1487974983, // -0.529297, 0.692892
1489990772, // -0.527344, 0.693831
1492009292, // -0.525391, 0.694771
1494030547, // -0.523438, 0.695712
1496054540, // -0.521484, 0.696655
1498081274, // -0.519531, 0.697598
1500110755, // -0.517578, 0.698544
1502142985, // -0.515625, 0.699490
1504177968, // -0.513672, 0.700437
1506215708, // -0.511719, 0.701386
1508256208, // -0.509766, 0.702337
1510299473, // -0.507813, 0.703288
1512345505, // -0.505859, 0.704241
1514394310, // -0.503906, 0.705195
1516445890, // -0.501953, 0.706150
1518500249, // -0.500000, 0.707107
1520557392, // -0.498047, 0.708065
1522617321, // -0.496094, 0.709024
1524680041, // -0.494141, 0.709984
1526745556, // -0.492188, 0.710946
1528813868, // -0.490234, 0.711909
1530884983, // -0.488281, 0.712874
1532958903, // -0.486328, 0.713840
1535035633, // -0.484375, 0.714807
1537115176, // -0.482422, 0.715775
1539197537, // -0.480469, 0.716745
1541282718, // -0.478516, 0.717716
1543370725, // -0.476563, 0.718688
1545461560, // -0.474609, 0.719662
1547555227, // -0.472656, 0.720637
1549651731, // -0.470703, 0.721613
1551751075, // -0.468750, 0.722590
1553853263, // -0.466797, 0.723569
1555958299, // -0.464844, 0.724550
1558066187, // -0.462891, 0.725531
1560176930, // -0.460938, 0.726514
1562290533, // -0.458984, 0.727498
1564406999, // -0.457031, 0.728484
1566526332, // -0.455078, 0.729471
1568648537, // -0.453125, 0.730459
1570773616, // -0.451172, 0.731448
1572901574, // -0.449219, 0.732439
1575032415, // -0.447266, 0.733432
1577166143, // -0.445313, 0.734425
1579302761, // -0.443359, 0.735420
1581442274, // -0.441406, 0.736416
1583584685, // -0.439453, 0.737414
1585729999, // -0.437500, 0.738413
1587878219, // -0.435547, 0.739413
1590029349, // -0.433594, 0.740415
1592183394, // -0.431641, 0.741418
1594340356, // -0.429688, 0.742423
1596500241, // -0.427734, 0.743428
1598663051, // -0.425781, 0.744435
1600828792, // -0.423828, 0.745444
1602997467, // -0.421875, 0.746454
1605169079, // -0.419922, 0.747465
1607343634, // -0.417969, 0.748478
1609521134, // -0.416016, 0.749492
1611701584, // -0.414063, 0.750507
1613884989, // -0.412109, 0.751524
1616071351, // -0.410156, 0.752542
1618260675, // -0.408203, 0.753561
1620452965, // -0.406250, 0.754582
1622648225, // -0.404297, 0.755604
1624846458, // -0.402344, 0.756628
1627047670, // -0.400391, 0.757653
1629251864, // -0.398438, 0.758680
1631459044, // -0.396484, 0.759707
1633669214, // -0.394531, 0.760737
1635882378, // -0.392578, 0.761767
1638098541, // -0.390625, 0.762799
1640317705, // -0.388672, 0.763832
1642539876, // -0.386719, 0.764867
1644765058, // -0.384766, 0.765903
1646993254, // -0.382813, 0.766941
1649224468, // -0.380859, 0.767980
1651458705, // -0.378906, 0.769020
1653695969, // -0.376953, 0.770062
1655936264, // -0.375000, 0.771105
1658179594, // -0.373047, 0.772150
1660425963, // -0.371094, 0.773196
1662675375, // -0.369141, 0.774244
1664927834, // -0.367188, 0.775292
1667183345, // -0.365234, 0.776343
1669441912, // -0.363281, 0.777394
1671703538, // -0.361328, 0.778448
1673968228, // -0.359375, 0.779502
1676235986, // -0.357422, 0.780558
1678506816, // -0.355469, 0.781616
1680780723, // -0.353516, 0.782675
1683057710, // -0.351563, 0.783735
1685337782, // -0.349609, 0.784797
1687620942, // -0.347656, 0.785860
1689907196, // -0.345703, 0.786924
1692196547, // -0.343750, 0.787990
1694488999, // -0.341797, 0.789058
1696784557, // -0.339844, 0.790127
1699083225, // -0.337891, 0.791197
1701385007, // -0.335938, 0.792269
1703689907, // -0.333984, 0.793342
1705997929, // -0.332031, 0.794417
1708309079, // -0.330078, 0.795493
1710623359, // -0.328125, 0.796571
1712940774, // -0.326172, 0.797650
1715261329, // -0.324219, 0.798731
1717585028, // -0.322266, 0.799813
1719911875, // -0.320313, 0.800896
1722241873, // -0.318359, 0.801981
1724575029, // -0.316406, 0.803068
1726911345, // -0.314453, 0.804156
1729250826, // -0.312500, 0.805245
1731593477, // -0.310547, 0.806336
1733939301, // -0.308594, 0.807428
1736288303, // -0.306641, 0.808522
1738640487, // -0.304688, 0.809618
1740995858, // -0.302734, 0.810714
1743354420, // -0.300781, 0.811813
1745716177, // -0.298828, 0.812912
1748081133, // -0.296875, 0.814014
1750449293, // -0.294922, 0.815116
1752820662, // -0.292969, 0.816221
1755195243, // -0.291016, 0.817326
1757573041, // -0.289063, 0.818434
1759954060, // -0.287109, 0.819542
1762338305, // -0.285156, 0.820653
1764725779, // -0.283203, 0.821764
1767116488, // -0.281250, 0.822878
1769510436, // -0.279297, 0.823993
1771907627, // -0.277344, 0.825109
1774308066, // -0.275391, 0.826227
1776711756, // -0.273438, 0.827346
1779118703, // -0.271484, 0.828467
1781528911, // -0.269531, 0.829589
1783942383, // -0.267578, 0.830713
1786359125, // -0.265625, 0.831838
1788779142, // -0.263672, 0.832965
1791202436, // -0.261719, 0.834094
1793629014, // -0.259766, 0.835224
1796058879, // -0.257813, 0.836355
1798492036, // -0.255859, 0.837488
1800928488, // -0.253906, 0.838623
1803368242, // -0.251953, 0.839759
1805811301, // -0.250000, 0.840896
1808257669, // -0.248047, 0.842036
1810707352, // -0.246094, 0.843176
1813160353, // -0.244141, 0.844319
1815616678, // -0.242188, 0.845462
1818076330, // -0.240234, 0.846608
1820539314, // -0.238281, 0.847755
1823005635, // -0.236328, 0.848903
1825475297, // -0.234375, 0.850053
1827948304, // -0.232422, 0.851205
1830424662, // -0.230469, 0.852358
1832904375, // -0.228516, 0.853513
1835387447, // -0.226563, 0.854669
1837873883, // -0.224609, 0.855827
1840363687, // -0.222656, 0.856986
1842856865, // -0.220703, 0.858147
1845353419, // -0.218750, 0.859310
1847853356, // -0.216797, 0.860474
1850356680, // -0.214844, 0.861639
1852863395, // -0.212891, 0.862807
1855373506, // -0.210938, 0.863976
1857887017, // -0.208984, 0.865146
1860403934, // -0.207031, 0.866318
1862924260, // -0.205078, 0.867492
1865448001, // -0.203125, 0.868667
1867975160, // -0.201172, 0.869844
1870505743, // -0.199219, 0.871022
1873039755, // -0.197266, 0.872202
1875577199, // -0.195313, 0.873384
1878118081, // -0.193359, 0.874567
1880662405, // -0.191406, 0.875752
1883210175, // -0.189453, 0.876938
1885761398, // -0.187500, 0.878126
1888316076, // -0.185547, 0.879316
1890874215, // -0.183594, 0.880507
1893435820, // -0.181641, 0.881700
1896000895, // -0.179688, 0.882894
1898569446, // -0.177734, 0.884090
1901141475, // -0.175781, 0.885288
1903716990, // -0.173828, 0.886487
1906295993, // -0.171875, 0.887688
1908878490, // -0.169922, 0.888891
1911464486, // -0.167969, 0.890095
1914053985, // -0.166016, 0.891301
1916646992, // -0.164063, 0.892508
1919243511, // -0.162109, 0.893717
1921843549, // -0.160156, 0.894928
1924447108, // -0.158203, 0.896141
1927054195, // -0.156250, 0.897355
1929664814, // -0.154297, 0.898570
1932278969, // -0.152344, 0.899788
1934896666, // -0.150391, 0.901006
1937517909, // -0.148438, 0.902227
1940142703, // -0.146484, 0.903449
1942771053, // -0.144531, 0.904673
1945402964, // -0.142578, 0.905899
1948038440, // -0.140625, 0.907126
1950677486, // -0.138672, 0.908355
1953320108, // -0.136719, 0.909586
1955966309, // -0.134766, 0.910818
1958616096, // -0.132813, 0.912052
1961269472, // -0.130859, 0.913287
1963926443, // -0.128906, 0.914525
1966587013, // -0.126953, 0.915763
1969251187, // -0.125000, 0.917004
1971918971, // -0.123047, 0.918246
1974590369, // -0.121094, 0.919490
1977265386, // -0.119141, 0.920736
1979944027, // -0.117188, 0.921983
1982626296, // -0.115234, 0.923232
1985312199, // -0.113281, 0.924483
1988001741, // -0.111328, 0.925735
1990694927, // -0.109375, 0.926990
1993391761, // -0.107422, 0.928245
1996092248, // -0.105469, 0.929503
1998796394, // -0.103516, 0.930762
2001504204, // -0.101563, 0.932023
2004215681, // -0.099609, 0.933286
2006930832, // -0.097656, 0.934550
2009649661, // -0.095703, 0.935816
2012372173, // -0.093750, 0.937084
2015098374, // -0.091797, 0.938353
2017828268, // -0.089844, 0.939625
2020561860, // -0.087891, 0.940897
2023299155, // -0.085938, 0.942172
2026040159, // -0.083984, 0.943448
2028784876, // -0.082031, 0.944727
2031533311, // -0.080078, 0.946006
2034285470, // -0.078125, 0.947288
2037041357, // -0.076172, 0.948571
2039800977, // -0.074219, 0.949856
2042564336, // -0.072266, 0.951143
2045331439, // -0.070313, 0.952432
2048102290, // -0.068359, 0.953722
2050876895, // -0.066406, 0.955014
2053655258, // -0.064453, 0.956308
2056437386, // -0.062500, 0.957603
2059223283, // -0.060547, 0.958901
2062012953, // -0.058594, 0.960200
2064806403, // -0.056641, 0.961500
2067603638, // -0.054688, 0.962803
2070404662, // -0.052734, 0.964107
2073209480, // -0.050781, 0.965413
2076018098, // -0.048828, 0.966721
2078830521, // -0.046875, 0.968031
2081646754, // -0.044922, 0.969342
2084466802, // -0.042969, 0.970655
2087290671, // -0.041016, 0.971970
2090118365, // -0.039063, 0.973287
2092949890, // -0.037109, 0.974606
2095785251, // -0.035156, 0.975926
2098624453, // -0.033203, 0.977248
2101467501, // -0.031250, 0.978572
2104314401, // -0.029297, 0.979898
2107165158, // -0.027344, 0.981225
2110019776, // -0.025391, 0.982555
2112878262, // -0.023438, 0.983886
2115740620, // -0.021484, 0.985219
2118606856, // -0.019531, 0.986553
2121476975, // -0.017578, 0.987890
2124350982, // -0.015625, 0.989228
2127228883, // -0.013672, 0.990568
2130110682, // -0.011719, 0.991910
2132996385, // -0.009766, 0.993254
2135885998, // -0.007813, 0.994599
2138779525, // -0.005859, 0.995947
2141676972, // -0.003906, 0.997296
2144578345 // -0.001953, 0.998647
};
